# Arbeitsbericht – Vulnerability Scanning
 
**Name:** Aldin Mukic  
**Datum:** 22.12.2025  
**Fach:** ITSE Labor  
**Klasse:** 4AHITS

**Aufgabe:** [Vulnerability Scanning](https://www.franzmatejka.at/htl/doc/ITSI_4/lab/04_vulnscan.html)


---
 
## Inhaltsverzeichnis

1. [Übung (nmap enumeration)](#1-übung-nmap-enumeration)  
   1.1 [Aufgabenstellung](#aufgabenstellung)  
   1.2 [Lösung](#lösung)  
   1.3 [Funktionsweise des SYN-Scans](#funktionsweise-des-syn-scans)  
   1.4 [Vorteile dieses Scans](#vorteile-dieses-scans)  
   1.5 [Analyse der Scan-Ergebnisse](#analyse-der-scan-ergebnisse)  

2. [Übung (vulnerability scan)](#2-übung-vulnerability-scan)  
   2.1 [Aufgabenstellung](#aufgabenstellung-1)  
   2.2 [Lösung](#lösung-1)  
   2.3 [Ausgewählte Skripte mit --script](#ausgewählte-skripte-mit---script)  
   2.4 [Weiteres sinnvolles Skript](#weiteres-sinnvolles-skript)  
---

Metasploitable IP:  192.168.7.51<br>
Kali Linux IP:      192.168.7.52<br>

# 1 Übung (nmap enumeration)

### Aufgabenstellung

**Aufgaben:**
 
**Enumeration** bezeichnet das gezielte Sammeln detaillierter Informationen über ein Zielsystem, wie Benutzer, Dienste, Freigaben, Versionen oder Konfigurationen. Sie folgt typischerweise auf den Portscan und dient dazu, konkrete Angriffsflächen für weitere Schritte (z. B. Exploits) zu identifizieren.<br>

In diesem Zusammenhang wird häufig der folgende Befehl verwendet:<br>
```bash
nmap -Pn -sS -sV -sC -oN nmap_default.txt 10.10.92.153
```
 
* Analysiere die Bedeutung der Optionen
* Was führt nmap in diesem Fall für einen besonderen Port-Scan aus?
* Was ist der Vorteil dieses Scans?
* Wie viele Ports werden gescannt?
* Scanne mit diesem Befehl die metasploitable VM

### Lösung 
**Nmap Enumeration Scan starten**

Mit dem Befehl starte ich es:<br>
```bash
nmap -Pn -sS -sV -sC -oN nmap_default.txt 192.168.7.51
```


| Option                 | Beschreibung                                                                              |
| ---------------------- | ----------------------------------------------------------------------------------------- |
| `-Pn`                  | Deaktiviert die Host-Erkennung (Ping). Nmap geht davon aus, dass das Ziel erreichbar ist. |
| `-sS`                  | Führt einen SYN-Scan (Half-Open Scan) durch.                                              |
| `-sV`                  | Ermittelt die laufenden Dienste und deren Versionsnummern.                                |
| `-sC`                  | Führt die Standard-NSE-Skripte aus (Enumeration).                                         |
| `-oN nmap_default.txt` | Speichert die Ausgabe im normalen Textformat in einer Datei.                              |
| `192.168.7.51`         | IP-Adresse der Metasploitable VM.                                                         |


Der in diesem Befehl verwendete Scan-Typ ist ein **SYN-Scan (`-sS`)**, auch bekannt als **Half-Open Scan**.

#### Funktionsweise des SYN-Scans

Es wird ein **SYN-Scan (`-sS`)** verwendet, auch bekannt als **Half-Open Scan**, der häufig bei Penetrationstests eingesetzt wird.

Dabei sendet Nmap ein **SYN-Paket** an den Zielport.  
Antwortet der Host mit **SYN/ACK**, gilt der Port als **offen**.  
Anschließend wird die Verbindung mit einem **RST-Paket** direkt abgebrochen, ohne sie vollständig aufzubauen.


#### Vorteile dieses Scans

- Sehr schneller Scan  
- Geringe Netzwerklast  
- Wird häufig nicht vollständig geloggt  
- Sehr zuverlässig  

Der **SYN-Scan** ist der **Standard-Scan für Penetrationstests**.

#### Analyse der Scan-Ergebnisse

Mit dem Befehl ```cat nmap_default.txt``` lies ich mir die Text-Datei anzeigen und untersuchte diese danach: <br>
Bei diesem Nmap-Scan wurden standardmäßig 1000 TCP-Ports untersucht. Nmap wählt dabei automatisch die am häufigsten verwendeten Ports aus, da diese typischerweise von wichtigen Netzwerkdiensten genutzt werden.<br>
In der Scan-Ausgabe wird angegeben, dass 977 dieser Ports geschlossen waren und deshalb nicht im Detail angezeigt werden. Die verbleibenden 23 Ports waren offen und wurden vollständig aufgelistet.<br>
Dies zeigt, dass das Zielsystem eine ungewöhnlich große Anzahl aktiver Dienste bereitstellt, was die Angriffsfläche deutlich erhöht.<br>


# 2 Übung (vulnerability scan)

### Aufgabenstellung

nmap verfügt über eine Erweiterung über die Lua Scripts ausgeführt werden können. Die installierten Lua Scripts befinden sich im Directory /usr/share/nmap/scripts (sieh dir den Inhalt des Directories an).<br>

### Lösung 
Ausführen der Standard-NSE-Skripte, beschränkt auf die 100 häufigsten Ports.<br>
```bash
nmap -Pn -sS -sV -sC -F -oN nmap_vuln_fast.txt 192.168.7.51

```

Die Option `-F` scannt nur die **100 häufigsten TCP-Ports** anstelle der üblichen 1000 Ports.  
Dadurch ist der Scan deutlich **schneller**.

Es wurden zahlreiche **offene und veraltete Dienste** gefunden, darunter FTP mit anonymem Login, Telnet, alte SSH- und Apache-Versionen sowie unsichere Datenbank- und Samba-Dienste.

Mehrere **unsichere Protokolle** (z. B. Telnet, SSLv2) sind aktiv und wichtige Schutzmechanismen fehlen.  

Bereits der Fast-Scan liefert klare Hinweise auf **schwere Sicherheitslücken**. Für eine vollständige Analyse sind weiterführende Scans und Enumeration notwendig.

### Ausgewählte Skripte mit --script

### Verwendete Skripte (5 Stück)

- `http-title`
- `mysql-info`
- `banner`
- `ftp-anon`
- `ssh-hostkey`

```bash
nmap -Pn -sS -sV --script http-title,mysql-info,banner,ftp-anon,ssh-hostkey -oN nmap_scripts_selected.txt 192.168.7.51
```

Der gezielte Nmap-Scan mit ausgewählten NSE-Skripten liefert konkrete und sicherheitsrelevante Informationen:

- **http-title**  
  - Webseite identifiziert als *„Metasploitable2 – Linux“*

- **mysql-info**  
  - Detaillierte Informationen zur MySQL-Version (*MySQL 5.0.51a*), klar veraltet

- **banner**  
  - Mehrere Dienste geben Banner mit Versionsinformationen preis  
  - Erleichtert Fingerprinting und Exploit-Recherche

- **ftp-anon**  
  - Anonymer FTP-Zugriff bestätigt → hohes Sicherheitsrisiko

- **ssh-hostkey**  
  - Verwendete SSH-Schlüssel (DSA/RSA) wurden ausgelesen  
  - Alte Schlüsselgrößen deuten auf schwache Kryptographie hin


Der Scan zeigt, dass zahlreiche Dienste **unnötig viele Informationen preisgeben** und bestätigt mehrere **kritische Fehlkonfigurationen**. 

### Weiteres sinnvolles Skript

**Gewähltes Skript:**<br>
`smb-os-discovery`

Die Metasploitable-VM nutzt **Samba**. Dieses Skript liefert wichtige Informationen wie:
- Betriebssystem  
- Rechnername  
- Domain  
- Samba-Version  

### Befehl
```bash
nmap -Pn -sS --script smb-os-discovery -p 139,445 -oN nmap_smb_discovery.txt 192.168.7.51
```

### Ergebnis

Das Zielsystem wurde eindeutig als **Linux-System** identifiziert.  
Es läuft **Samba 3.0.20 (Debian)**, eine **veraltete Version** mit bekannten Schwachstellen.

Zusätzlich wurden folgende Informationen ermittelt:
- Rechnername: `metasploitable`
- Domain: `localdomain`
- FQDN: `metasploitable.localdomain`

Die Ergebnisse bestätigen eine **angreifbare Samba-Konfiguration** und liefern eine gute Grundlage für weitere Enumeration und Exploit-Recherche.

```bash
┌──(kali㉿kali)-[~]
└─$ nmap -Pn -sS --script smb-os-discovery -p 139,445 -oN nmap_smb_discovery.txt 192.168.7.51

Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-22 06:49 EST
Nmap scan report for 192.168.7.51
Host is up (0.00078s latency).

PORT    STATE SERVICE
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds
MAC Address: 00:0C:29:3D:51:CE (VMware)

Host script results:
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-11-24T07:58:10-05:00

Nmap done: 1 IP address (1 host up) scanned in 0.33 seconds
```

---
Bis hier hin bin ich heute am 22.12.2025 gekommen: Bis Übung (vulnerability scan), Aufgabe 3 fertig